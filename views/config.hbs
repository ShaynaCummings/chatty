{{!< layout}}
<div class="aui-message error" ng-class="{hidden: !error.title}" ng-cloak>
  <p class="title">
    <span class="aui-icon icon-error"></span>
    <strong>[[error.title]]</strong>
  </p>
  <p>[[error.msg]]</p>
</div><!-- .aui-message -->

<div class="aui-group intro-header">
  <div class="aui-item">
    <h1>Script Configuration</h1>
  </div>
</div>
<table class="aui" ng-cloak>
  <tbody ng-repeat="script in scripts | orderBy:'name'">
    <tr ng-class="{enabled: script.enabled, disabled: !script.enabled}">
      <td width="20">
        <div class="checkbox">
          <input type="checkbox" class="checkbox" name="script-enabled-[[script.name]]" ng-model="script.enabled" ng-checked="script.enabled" ng-change="updateScript(script)" ng-disabled="script.conf.required||script.varsRequired">
        </div>
      </td>
      <td class="script-name"><strong>[[script.name]]</strong></td>
      <td class="right toolcol">
        <button class="aui-button aui-button-subtle" ng-click="toggleConfig($event)">
          <span class="aui-icon aui-icon-small aui-iconfont-expanded" ng-show="expanded==$index">Collapse</span>
          <span class="aui-icon aui-icon-small aui-iconfont-collapsed" ng-show="expanded!=$index">Expand</span>
        </button>
      </td>
    </tr>
    <tr class="script-config hidden" id="script-config-[[$index]]">
      <td colspan="3">
        <table class="aui" ng-cloak>
          <thead ng-show="script.commands.length > 0">
            <tr>
              <th colspan="3">Commands</th>
            </tr>
          </thead>
          <tbody ng-show="script.commands.length > 0">
            <tr ng-repeat="command in script.commands">
              <td>/[[command.name.join(', /')]]</td>
              <td>[[command.args]]</td>
              <td>[[command.help]]</td>
            </tr>
          </tbody>
          <thead ng-show="script.spies.length > 0">
            <tr>
              <th colspan="3">Spies</th>
            </tr>
          </thead>
          <tbody ng-show="script.spies.length > 0">
            <tr ng-repeat="spy in script.spies">
              <td>[[spy.hear.toString()]]</td>
              <td></td>
              <td>[[spy.help]]</td>
            </tr>
          </tbody>
          <thead ng-show="Object.keys(script.varspec).length > 0">
            <tr>
              <th colspan="3">Variables</th>
            </tr>
          </thead>
          <tbody ng-show="Object.keys(script.varspec).length > 0">
            <tr ng-repeat="(key, spec) in script.varspec">
              <td>[[spec.name]]</td>
              <td colspan="2">
                <form class="aui">
                  <input class="text long-field" type="text" value="" placeholder="[[spec.value]]" ng-model="script.variables[key]" ng-change="updateVars(script)">
                </form>
              </td>
            </tr>
            <tr>
              <td colspan="3" class="right">
                <button class="aui-button" ng-click="saveScript(script)">
                  <span class="aui-icon aui-icon-small aui-iconfont-success"></span>
                  <span>Save</span>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </td>
    </tr>
  </tbody>
  <tbody ng-class="{hidden: scripts.length > 0}" ng-cloak>
    <tr>
      <td class="centered" colspan="3">
        There are no available scripts
      </td>
    </tr>
  </tbody>
</table>
